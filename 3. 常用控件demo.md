# 三、常用控件

### 3.1 设置窗口图标 QIcon
- 将 cat.jpg 设置为窗口图标，并设置窗口标题为Icon
<img src=".\fig\3.cat.jpg" alt="3.cat" style="zoom:50%;" />

- demo 实现
```python
import sys
from PyQt5.QtWidgets import QApplication, QWidget
from PyQt5.QtGui import QIcon

class Example(QWidget):
    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        self.setGeometry(400, 300, 400, 300)
        self.setWindowTitle("Icon")       # 设置窗口标题
        icon = QIcon('../fig/cat.jpg')    # 设置窗口图标
        self.setWindowIcon(icon)

        # ---------------------------------------------------------------------------
        # self.setWindowIcon(QIcon())    # 设置图标之后，如果想取消图标，加上这行代码即可
        # ---------------------------------------------------------------------------

        self.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```
- 结果展示

<img src=".\fig\3.设置图标.png" alt="3.设置图标" style="zoom:80%;" />

### 3.2 设置Qt 内置图标
```python

import sys
from PyQt5.QtWidgets import QApplication, QWidget, QStyle


class Example(QWidget):
    # 初始化，调用父类 __init__ 方法
    def __init__(self):
        super().__init__()
        # 4.调用 initUi 方法
        self.initUi()

    # 编写内置图标
    def initUi(self):

        # 实现原理：通过 `QStyle.StandardPixmap` 枚举，此枚举引用了可用的标准像素图
        # 要换内置图标，换下标即可
        self.setWindowIcon(QApplication.style().standardIcon(0))  # Qt 图标
        # self.setWindowIcon(QApplication.style().standardIcon(1))  # 最小化按钮图标
        # self.setWindowIcon(QApplication.style().standardIcon(2))  # 最大化按钮图标
        # self.setWindowIcon(QApplication.style().standardIcon(3))  # 关闭按钮图标

        self.setWindowTitle('Build in Icon')
        self.setGeometry(400, 300, 400, 300)
        self.show()

# 实例化 Example
if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec())
```

- Qt 图标
<img src=".\fig\3.设置图标-2.png" alt="3.设置图标-2" style="zoom:80%;" />


### 3.3 标签 QLabel

>创建标签对象，QLabel 可以接收两个参数，一个是标签名，另一个是父级，所谓的父级就是把它自己绑定在谁的上面。self 是指将标签控件绑定在 QWidget 上
>`QLabel("人生苦短，我用 Python", self)`

- 案例需求：

1）创建标签名为“人生苦短，我用 Python 的标签”  `QLabel`
2）给标签设置位置和宽高           `setGeometry`
3）给标签设置边框，为了方便观看效果  `setStyleSheet`
4）设置文本居中            `setAlignment`
5）获取文本内容             `text()`

- 案例实现
```python
import sys
from PyQt5.QtWidgets import QWidget, QApplication, QLabel
from PyQt5.QtCore import Qt

class Example(QWidget):

    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        # 案例实现：
        # 1. 创建标签对象
        label = QLabel("人生苦短，我用 Python", self)
        # 2. 设置标签对象的位置、宽高
        label.setGeometry(100, 100, 200, 50)
        # 3. 设置标签对象的样式 边框样式：2px 实线 红色
        label.setStyleSheet("""border: 2px solid red""")
        # 4. 标签对象在窗口中 水平+垂直居中
        label.setAlignment(Qt.AlignCenter | Qt.AlignVCenter)
        # 5. 打印标签文本内容
        print(label.text())

        self.setGeometry(300, 300, 400, 320)  # 窗口的位置、宽高
        self.setWindowTitle('标签控件')        # 窗口标题
        self.show()                           # 窗口显示


if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```

<img src=".\fig\3.设置标签lable.png" alt="3.设置标签lable" style="zoom:80%;" />


### 3.4 单行文本编辑器 QLineEdit
可以输入单行字符串，但是不可以换行输入。有明文输出模式和密文输出模式。

QLineEdit 的常用方法
- setAlignment()：设置文本对齐方式，可选值见 QLabel 的 setAlignment() 方法的可选值，用法一样
- **clear()：清除文本框内容**
- **setEchoMode()：设置文本输出模式**，枚举值如下：
    - **QLineEdit.Normal**：正常显示输入的字符，此为**默认**选项
    - QLineEdit.NoEcho：不显示任何输入的字符，用于密码类型的输入且密码长度需要保密的场景；
    - QLineEdit.Password：密文显示，显示与平台相关的密码掩码字符，而非实际输入的字符
    - **QLineEdit.PasswordEchoOnEdit**：在编辑时显示字符，编辑后显示密文,常用于密码输入
- **setPlaceholderText()：设置文本框提示文本**
- setMaxLength()：设置文本框允许输入的最大字符数
- setReadOnly()：设置文本框为只读，不可写
- **setText()：设置文本框内容**
- **text()：获取文本框内容**
- setFocus()：获取焦点
- setValidator()：设置文本验证器，将限制任意可能输入的文本，可用的验证器有：
= QIntValidator：只能输入整数
- QDoubleValidator：只能输入浮点数
- QRegexpValidator：检查输入是否符合正则表达式
- setInputMask(mask_str)：设置掩码


**用户登陆界面**
- 案例需求：
1）创建三个单行文本编辑器，分别是账号输入框、密码输入框和邮箱输入框
2）给密码框设置密码输出模式
3）给邮箱输入框设置掩码格式限制，长度限制为 10 位，允许任何 ASCII 字符输入
4）给三个输入框设置文本提示（setPlaceholderText）

- 案例实现
```PYTHON
import sys
from PyQt5.QtWidgets import QWidget, QApplication, QLineEdit, QLabel
from PyQt5.QtCore import Qt

class Example(QWidget):

    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        # 1. 创建标签、行编辑控件
        account = QLabel("账号", self)
        account_line = QLineEdit(self)

        password = QLabel("密码", self)
        password_line = QLineEdit(self)

        mail = QLabel("邮箱", self)
        mail_line = QLineEdit(self)

        # 设置控件位置，如果不设置就全部叠在一起了 
        # 这个也可以通过 Qt Designer 设置
        account.move(30, 15)
        password.move(30, 45)
        mail.move(30, 75)

        account_line.move(60, 10)
        password_line.move(60, 40)
        mail_line.move(60, 70)

        # 2. 设置输出模式 密码输入模式
        password_line.setEchoMode(QLineEdit.Password)
        # 3. 设置掩码，长度限制为 10 位
        mail_line.setInputMask('xxxxxxxxxx@163.com; ')

        # 4. 设置提示文本
        account_line.setPlaceholderText("请输入用户名")
        password_line.setPlaceholderText("请输入密码")

        self.setGeometry(300, 300, 400, 320)
        self.setWindowTitle('单行文本编辑器控件')
        self.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```

<img src=".\fig\3.Qlineedit.png" alt="3.Qlineedit" style="zoom:80%;" />



###  3.5 多行文本编辑器  QTextEdit
QTextEdit可以输入多行文本字符串，当文本内容超出控件显示范围时，可以显示水平和垂直滚动条，QTextEdit 不仅可以用来输入文本还可以用来显示 HTML 文档

**QTextEdit 的常用方法**
- **setText()：给文本框添加内容**
- **toPlainText()：获取文本框中的文本内容**
- setHtml()：给文本框的文本内容设置为 HTML 文档
- toHtml()：获取文本框中的 HTML 文本内容
- **clear()：清除文本框中的文本**

利用编辑器显示不同文档
- 案例需求：
1）创建一个多行行文本编辑器，和两个按钮
2）当显示文本按钮本点击时，显示内容为："你好，派森诺生物 !"
3）当显示 HTML 按钮本点击时，显示内容为：
- 案例实现
```python
import sys
from PyQt5.QtWidgets import (
    QApplication, QWidget, QTextEdit,
    QVBoxLayout, QPushButton
)

class Example(QWidget):
    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):

        # 1. 创建多行文本编辑器控件
        self.text = QTextEdit()
        # 1. 创建两个按钮 控件
        self.show_text = QPushButton("显示文本")
        self.show_html = QPushButton("显示 HTML")

        # 创建垂直布局管理器
        layout = QVBoxLayout()
        # 向垂直布局管理器中添加控件
        layout.addWidget(self.text)
        layout.addWidget(self.show_text)
        layout.addWidget(self.show_html)
        # 将布局管理器添加到 QWidget 的布局中
        self.setLayout(layout)

        # 给两个按钮空格键绑定点击槽函数（事件）
        # 2. 当显示文本按钮本点击时，显示内容
        self.show_text.clicked.connect(self.show_text_click)
        # 3. 当显示 HTML 按钮本点击时，显示内容
        self.show_html.clicked.connect(self.show_html_click)

        self.setGeometry(200, 200, 400, 320)
        self.setWindowTitle("多行文本编辑器")
        self.show()

    def show_text_click(self):
        """2. 显示文本按钮控件槽函数"""

        # 设置文本
        self.text.setPlainText("你好，派森诺生物!")

    def show_html_click(self):
        """3. 显示 HTML 按钮控件槽函数"""

        # 设置 HTML
        self.text.setHtml("<p style='color:red;font-size:30px'>你好，派森诺生物!</p>")

if __name__ == "__main__":
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```

<img src=".\fig\3.Qtextedit.png" alt="3.Qtextedit" style="zoom:80%;" />

### 3.6  按钮分组器   QGroupButton 

 QGroupButton 对象是一个按钮分组器，是一个抽象的按钮容器，继承自 QObject 类，不具备可视化功能。 

#### QGroupButton 的常用方法

- buttons()：查看所有按钮组中的按钮
- button()：根据 ID 获取按钮, 没有则返回 None
- checkedButton()：获取选中的按钮
- removeButton(QAbstractButton)：删除按钮，不是从界面上移除，是从抽象关系上移除

创建一个性别选项复选框
- 案例需求：
1）创建一个按钮分组器和两个单选按钮
2）两个单选按钮具有互斥性，默认“男”按钮被选中
3） 给单选按钮设置 ID
4）打印按钮分组器中所有的按钮对象
5）打印 ID=2 的按钮文本
6）打印被按下的按钮文本

- 案例实现
```PYTHON
import sys
from PyQt5.QtWidgets import QApplication, QWidget, QButtonGroup, QRadioButton

class Example(QWidget):
    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        # 1. 创建按钮分组器控件
        group = QButtonGroup(self)
        # 创建单选按钮控件
        male = QRadioButton('男', self)
        female = QRadioButton('女', self)
        male.move(150, 100)
        female.move(200, 100)

        # 2. 设置“男”单选框被默认选中
        male.setChecked(True)

        # 将单选按钮添加到按钮分组器中，这时这两个单选按钮具有互斥性，只能选中一个
        group.addButton(male)
        group.addButton(female)

        # 3. 给单选按钮设置 ID
        group.setId(male, 1)
        group.setId(female, 2)

        # 4. 打印按钮分组器中所有的按钮对象
        print(group.buttons())
        
        # 5. 打印 ID=2 的按钮文本
        print(group.button(2).text())
        
        # 6. 打印被按下的按钮文本
        print(group.checkedButton().text())

        self.setWindowTitle('按钮分组器')
        self.setGeometry(200, 200, 400, 320)
        self.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```

<img src=".\fig\3.Qgroupbutton.png" alt="3.Qgroupbutton" style="zoom:80%;" />



### 3.7  表格控件   QTableWidget 

 QTableWidget 对象是一个表格控件，继承自 QTableView 类，是 PyQt5 中的高级显示控件之一。它的每一个单元格都是一个标准的数据模型，每个单元格都是一个 QTableWidgetItem 对象.

-  如果想往表格单元格中添加文本，就必须要创建 QTableWidgetItem 对象，因为 setItem 方法只接受 QTableWidgetItem 作为文本数据。 

#### QTableWidget 的常用方法

- **setRowCount()：设置行数**
- **setColumnCount()：设置列数**
- **setHorizontalHeaderLabels()：设置水平方向表头**
- **setVerticalHeaderLabels()：设置垂直方向表头**
- setItem()：给单元格添加数据
- setCellWidget()：给单元格添加控件
- rowCount()：获取表格的行数
- columnCount()：获取表格的列数
- setTextAlignment()：设置单元格文本对齐方式
- setShowGrid()：默认为 True，在默认情况下表格会显示网格线
- setColumnWidth()：设置单元格的宽度
- setRowHeight()：设置单元格的高度

#### 表格选择行为的枚举值

- QAbstractItemView.SelectItems0Selecting：选中单个单元格
- QAbstractItemView.SelectRows1Selecting：选中一行
- QAbstractItemView.SelectColumns2Selecting：选中一列

**创建一个窗口来显示表格数据**
- 案例需求：
1）创建一个四行三列的表格控件
2）水平表头显示“姓名”、“性别”、“体重”三个字段，垂直表头隐藏
3）水平单元格水平方向自适应伸缩
4）将单元格设置为禁止编辑模式
5）设置表格整行选中
6）添加一条数据
- 案例实现
```python
import sys
from PyQt5.QtWidgets import (
    QApplication, QWidget, QTableWidget, QTableWidgetItem,
    QHeaderView
)
from PyQt5.QtCore import Qt


class Example(QWidget):
    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        # 1. 创建一个四行三列的表格控件
        table = QTableWidget(4, 3, self)
        table.resize(420, 320)

        # 2. 设置水平方向的表头标签，必须在表格控件初始化行列之后进行，否则，没有效果
        table.setHorizontalHeaderLabels(['姓名', '性别', '体重'])
        # 2. 隐藏垂直表头
        table.verticalHeader().setVisible(False)

        # 3. 单元格水平方向自适应伸缩模式
        table.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)

        # 4. 将单元格设置为禁止编辑模式 (默认为可编辑)
        table.setEditTriggers(QTableWidget.NoEditTriggers)

        # 5. 设置表格整行选中
        table.setSelectionBehavior(QTableWidget.SelectRows)

        # 6. 添加数据
        newItem = QTableWidgetItem('张三')
        newItem.setTextAlignment(Qt.AlignCenter) # 文本居中
        table.setItem(0, 0, newItem)

        newItem = QTableWidgetItem('男')
        newItem.setTextAlignment(Qt.AlignCenter)
        table.setItem(0, 1, newItem)

        newItem = QTableWidgetItem('160')
        newItem.setTextAlignment(Qt.AlignCenter)
        table.setItem(0, 2, newItem)

        self.setWindowTitle("表格")
        self.setGeometry(200, 200, 420, 320)
        self.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```

<img src=".\fig\3.表格显示.png" alt="3.表格显示" style="zoom:80%;" />

### 3.8 按钮 QPushButton 和 提示框 QToolTip
QToolTip 是提示框对象，常常被用来显示提示语
QPushButton 是常用的按钮对象，继承自 QAbstractButton。按下（或者单击） QPushButton 按钮会给 APP 窗口发送按钮点击信号，让这个窗口执行某个操作或者处理相应的信息或数据，这都是依赖于 PyQt5 的信号与槽机制进行的。

**QToolTip 的常用方法**
- setFont：设置提示框的文本字体，接受 QFont 对象作为参数。QFont 对象是 PyQt5.QtGui 中的一个类。
`QToolTip.setFont(QFont('字体', 大小))`
- showText：显示提示框中的提示文本
- hideText：隐藏提示框中的提示文本
- text：获取提示框中的提示文本

**QPushButton 的常用方法**
- setIcon()：设置按钮上的图标
- text()：获取按钮的显示文本
- setText()：设置按钮的显示文本
- isChecked()：返回按钮的选中状态，选中则返回 True
- setEnabled()：接受一个布尔值，设置按钮是否可用，设置为 False 时，按钮不可用（不可点击）
- setCheckable()：接受一个布尔值，设置按钮是否已经被选中，如果设置 True，则表示按钮将保持已点击状态

**退出按钮，显示按钮提示信息**
- 案例需求：
1）创建一个按钮
2）给按钮设置提示文本，字体设置为微软雅黑 14 号字体
3）给按钮连接退出槽（退出事件）

- 案例实现
```python
import sys
from PyQt5.QtWidgets import QWidget, QApplication, QPushButton, QToolTip
from PyQt5.QtCore import QCoreApplication
from PyQt5.QtGui import QFont

class Example(QWidget):

    def __init__(self):
        super().__init__()
        self.initUI()

    def initUI(self):
        self.setGeometry(240, 200, 400, 300)
        self.setWindowTitle("窗口关闭事件")

        # 1. 给提示语设置字体 这里用的字体是：微软雅黑 14px
        QToolTip.setFont(QFont('微软雅黑', 14))

        # 2. 创建退出按钮
        button = QPushButton('退出', self)
        
        # 3. 给按钮添加提示语
        self.setToolTip('<b>点我</b>可以<i style="color:blue">关闭窗口</i>')
        
        # 4. 绑定点击事件（信号） 点击了就会关闭窗口（槽函数）
        button.clicked.connect(QCoreApplication.instance().quit)

        self.show()

# 5.实例化对象 主循环开始
if __name__ == '__main__':
    app = QApplication(sys.argv)
    e = Example()
    sys.exit(app.exec_())
```
<img src=".\fig\3.退出按钮.png" alt="3.退出按钮" style="zoom:80%;" />

### 3.9 消息盒子  QMessageBox
QMessageBox 是一种通用的弹出式对话框，用于显示消息，允许用户通过单击不同的标准按钮对消息进行反馈.
QMessageBox 类提供了许多常用的弹出式对话框，如提示框、警告框、错误框、询问框、关于框等会话框
**QMessageBox 对象的标准按钮**
|类型 |描述|
|-|-|
|QMessage.Cancel |取消操作|
|**QMessage.Yes** |同意操作|
|**QMessage.No** |取消操作|
|**QMessage.Ok** |同意操作|
|QMessage.Abort |终止操作|
|QMessage.Retry |重试操作|
|QMessage.Ignore |忽略操作|

**5 种常用的消息对话框及效果**
|类型	|作用	|用法|
|-|-|-|
|消息对话框	|提示消息	|`QMessageBox.information(self, '标题', '消息对话框正文', QMessageBox.Yes | QMessageBox.No, QMessageBox.Yes)`|
|提问对话框	|提问消息	|`QMessageBox.question(self, '标题', '提问框消息正文', QMessageBox.Yes | QMessageBox.No, QMessageBox.Yes)`|
|警告对话框	|不寻常的错误消息	|`QMessageBox.warning(self, '标题', '警告框消息正文', QMessageBox.Yes | QMessageBox.No, QMessageBox.Yes)`|
|错误对话框	|严重的错误消息	|`QMessageBox.critical(self, '标题', '严重错误对话框消息正文', QMessageBox.Yes | QMessageBox.No, QMessageBox.Yes)`|
|关于对话框	|提示消息	|`QMessageBox.about(self, '标题', '关于对话框')`|


### tips -- 1. 掩码 

掩码可以在指定位置上显示固定的数据类型，达到格式限制的目的。
- QLineEdit 对象可以通过 `setInputMask(mask_str)` 方法设置掩码

|字符	|含义|
|-|-|
|A	|ASCII 字母字符 A-Z，a-z，必须输入|
|a	|ASCII 字母字符 A-Z，a-z，允许输入，但不是必须的|
|N	|ASCII 字母和数字字符 A-Z，a-z，0-9，必须输入|
|n	|ASCII 字母和数字字符 A-Z，a-z，0-9，允许输入，但不是必须的|
|X	|ASCII 任何字符，必须输入|
|x	|ASCII 任何字符，允许输入，但不是必须的|
|9	|ASCII 数字字符 0-9，必须输入|
|0	|ASCII 数字字符 0-9，允许输入，但不是必须的|
|D	|ASCII 数字字符 1-9，必须输入|
|d	|ASCII 数字字符 1-9，允许输入，但不是必须的|
|#	|ASCII 数字与加减字符，允许输入的，但不是必须的|
|H	|十六进制格式字符 A-F，a-f，0-9，必须输入|
|h	|十六进制格式字符 A-F，a-f，0-9，允许输入，但不是必须的|
|B	|二进制格式字符 0,1，必须输入|
|b	|二进制格式字符 0,1，允许输入，但不是必须的|
|>	|所有字母字符都大写|
|<	|所有字母字符都小写|
|！	|关闭大小写转换|
|\	|使用 \ 转义上面列出的字符|

### tips -- 2. 窗口居中 

**窗口居中实现方法**
1. 第一种是通过获取主机显示器的分辨率中心点的坐标，然后将窗口的中心点与屏幕的中心点重合，因此实现窗口居中。实现代码如下：
```PYTHON
# 获取窗口坐标
qr = self.frameGeometry()
# 获取屏幕中心点坐标
cp = QDesktopWidget().availableGeometry().center()
# 将窗口移动到屏幕中心点
qr.moveCenter(cp)
```
<img src=".\fig\3. Qt坐标系.png" alt="3. Qt坐标系" style="zoom:80%;" />

2. 第二种是通过获取系统桌面的屏幕分辨率和窗口的大小（左上角和右下角两个点的坐标），然后将二者的宽度和高度各自相减除以二，计算得到系统桌面的中心点坐标，最后将窗口的中心与系统桌面的中心重合
```PYTHON
# 获取显示器分辨率
screen = QDesktopWidget().screenGeometry()
# 获取窗口大小
size = self.geometry()

self.move(
    (screen.width() - size.width()) / 2,
    (screen.height() - size.height()) / 2
)
```

- windows 系统推荐使用第一种
- Linux 系统推荐使用第二种